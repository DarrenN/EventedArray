// Generated by CoffeeScript 1.6.3
(function() {
  var Enumerable, root,
    __slice = [].slice;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  Enumerable = (function() {
    function Enumerable() {
      this.values = _.toArray(arguments);
      this.events = {};
      if (((typeof _ !== "undefined" && _ !== null) && typeof _ === "function") === false) {
        throw new Error("Underscore.js is required");
      }
    }

    Enumerable.prototype.set = function(value) {
      this.values.push(value);
      return this.trigger('set', value);
    };

    Enumerable.prototype.get = function(index) {
      var val;
      if (this.values[index] != null) {
        val = this.values[index];
      }
      if (val != null) {
        return this.trigger('get', val);
      }
    };

    Enumerable.prototype.remove = function(value) {
      var index, val, values;
      index = _.indexOf(this.values, value);
      if (index === -1) {
        this.trigger('remove', false);
      }
      val = this.values[index];
      values = this.values.slice(0, index).concat(_.rest(this.values, index + 1));
      this.values = values;
      return this.trigger('remove', val);
    };

    Enumerable.prototype.pop = function() {
      this.values.pop();
      return this.trigger('pop');
    };

    Enumerable.prototype.each = function(fn, context) {
      var _this = this;
      return _.each(this.values, function(v) {
        _this.trigger('each', v);
        return fn(v);
      }, context);
    };

    Enumerable.prototype.map = function(fn, context) {
      return this.trigger('map', _.map(this.values, fn, context));
    };

    Enumerable.prototype.forEach = function(fn, context) {
      return this.each(fn, context);
    };

    Enumerable.prototype.reduce = function(fn, memo, context) {
      return this.trigger('reduce', _.reduce(this.values, fn, memo, context));
    };

    Enumerable.prototype.reduceRight = function(fn, memo, context) {
      return this.trigger('reduceRight', _.reduce(this.values, fn, memo, context));
    };

    Enumerable.prototype.register = function(event, fn) {
      return this.events[event] = fn;
    };

    Enumerable.prototype.trigger = function() {
      var args, event;
      event = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
      if ((event != null) && (this.events[event] != null)) {
        this.events[event](args);
      }
      return this.cleanReturnVal(args);
    };

    Enumerable.prototype.cleanReturnVal = function(val) {
      if (val instanceof Array && val.length === 1) {
        return val[0];
      }
      return val;
    };

    Enumerable.prototype.toString = function() {
      return this.values.toString();
    };

    return Enumerable;

  })();

  if (typeof module === 'object' && module && typeof module.exports === 'object') {
    module.exports = Enumerable;
  } else if (typeof exports === 'object' && exports) {
    exports.Enumerable = Enumerable;
  } else if (typeof define === 'function' && define.amd) {
    define('enumerable', [], function() {
      return Enumerable;
    });
  } else {
    root.Enumerable = Enumerable;
  }

}).call(this);
